<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
		<meta name="keywords" content="{{{$keywords}}}" />
		<meta name="author" content="{{{author}}}" />
		<meta name="copyright" content="{{{copyright}}}" />
		<title>{{title}}</title>
		{{^activeSession}}
			<link type="text/css" rel="stylesheet" href="{{CDNPath}}/styles/webapp/common.css" />
			<link type="text/css" rel="stylesheet" href="{{CDNPath}}/styles/webapp/legacy.css" />
			<!--[if lte IE 7]>
				<link type="text/css" rel="stylesheet" href="{{CDNPath}}/styles/webapp/ie.css"/>
			<![endif]-->
		{{/activeSession}}
		{{#activeSession}}
			<link type="text/css" rel="stylesheet" href="{{CDNPath}}/styles/webapp/{{{urlCSS}}}" />
			<link type="text/css" rel="stylesheet" href="{{CDNPath}}/styles/lightbox.min.css" />
			<!--[if gte IE 8]>
				<script src="{{CDNPath}}/scripts/polyfills/html5shiv.js"></script>
			<![endif]-->
		{{/activeSession}}
		<script>document.cookie='resolution='+Math.max(window.innerWidth, window.innerHeight)+("devicePixelRatio" in window ? ","+devicePixelRatio : ",1")+'; path=/';</script>
		<script type="text/javascript">
			var hasTheMustard = false,
			determiningDevice = false,
			cookieEnabled = true,
			IEVer, 
			xmlhttp,
			screenWidth = screen.width;
		</script>
		{{^activeSession}}
			<script type="text/javascript">
				if (navigator.cookieEnabled === false) {
					cookieEnabled = false;
				}
				if (navigator.appName == 'Microsoft Internet Explorer'){
					var ua = navigator.userAgent;
					var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
					if (re.exec(ua) != null)
					IEVer = parseFloat( RegExp.$1 );
				}
				if ('querySelector' in document && 'localStorage' in window && 'addEventListener' in window) {
					if (screenWidth <= 240) {
						hasTheMustard = false;
					} else {
						hasTheMustard = true;
					}
				}
				if ((hasTheMustard == true || IEVer > 7) && (cookieEnabled == true)) {  
					console.log('in here');
					determiningDevice = true;
					if (window.XMLHttpRequest) {
						// code for IE7+, Firefox, Chrome, Opera, Safari
						xmlhttp = new XMLHttpRequest();
					} else {
						// code for IE6, IE5
						xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
					}
					xmlhttp.open("GET", "webApp/session?screenWidth="+screenWidth+"");
					xmlhttp.send();
					xmlhttp.onreadystatechange = function(){
						if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {	
							window.location.reload();
						} 
					}
				}
			</script>
		{{/activeSession}}
		{{#activeSession}}
			<script src="/scripts/lib/require.js" type="text/javascript"></script>
			<script src="/scripts/gallery/main.js" type="text/javascript"></script>
			<!-- <script type="text/javascript">
				require (['/gallery/gallery'], function () {});
			</script> -->
		{{/activeSession}}
	</head>
